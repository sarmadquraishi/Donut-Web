{"ast":null,"code":"const express = require('express');\nconst mongoose = require('mongoose');\nconst cors = require('cors');\nrequire('dotenv').config();\nconst app = express();\n\n// Middleware\napp.use(cors({\n  origin: 'http://localhost:3000',\n  credentials: true\n}));\napp.use(express.json());\n\n// MongoDB Connection\nmongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/donutshop', {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n}).then(() => console.log('âœ… MongoDB Connected')).catch(err => {\n  console.log('âŒ MongoDB Connection Error:', err.message);\n  console.log('âš ï¸  Running in demo mode (no database)');\n});\n\n// Order Schema\nconst orderSchema = new mongoose.Schema({\n  customer: {\n    fullName: String,\n    email: String,\n    phone: String,\n    address: String,\n    city: String,\n    postalCode: String\n  },\n  items: [{\n    productId: String,\n    name: String,\n    price: Number,\n    quantity: Number,\n    image: String\n  }],\n  subtotal: Number,\n  shipping: Number,\n  tax: Number,\n  total: Number,\n  paymentMethod: String,\n  status: {\n    type: String,\n    default: 'pending'\n  }\n}, {\n  timestamps: true\n});\nconst Order = mongoose.model('Order', orderSchema);\n\n// Test route\napp.get('/api/test', (req, res) => {\n  res.json({\n    message: 'Backend is working!',\n    timestamp: new Date()\n  });\n});\n\n// Create order - FIXED 400 ERROR\napp.post('/api/orders', async (req, res) => {\n  try {\n    console.log('ðŸ“¦ Received order request:', req.body);\n\n    // Validate required fields\n    if (!req.body.customer || !req.body.items) {\n      return res.status(400).json({\n        success: false,\n        message: 'Missing required fields: customer and items'\n      });\n    }\n\n    // Create order in database\n    const order = new Order({\n      ...req.body,\n      status: 'pending'\n    });\n    const savedOrder = await order.save();\n    console.log('âœ… Order saved to DB:', savedOrder._id);\n    res.status(201).json({\n      success: true,\n      message: 'Order created successfully',\n      order: savedOrder,\n      orderId: savedOrder._id\n    });\n  } catch (error) {\n    console.error('âŒ Order creation error:', error.message);\n\n    // Send detailed error for debugging\n    res.status(500).json({\n      success: false,\n      message: 'Failed to create order',\n      error: error.message,\n      details: error.errors || 'No additional details'\n    });\n  }\n});\n\n// Get all orders\napp.get('/api/orders', async (req, res) => {\n  try {\n    const orders = await Order.find().sort({\n      createdAt: -1\n    });\n    res.json({\n      success: true,\n      count: orders.length,\n      orders: orders\n    });\n  } catch (error) {\n    res.status(500).json({\n      success: false,\n      message: 'Failed to fetch orders'\n    });\n  }\n});\n\n// Get single order\napp.get('/api/orders/:id', async (req, res) => {\n  try {\n    const order = await Order.findById(req.params.id);\n    if (!order) {\n      return res.status(404).json({\n        success: false,\n        message: 'Order not found'\n      });\n    }\n    res.json({\n      success: true,\n      order: order\n    });\n  } catch (error) {\n    res.status(500).json({\n      success: false,\n      message: 'Failed to fetch order'\n    });\n  }\n});\n\n// Health check\napp.get('/api/health', (req, res) => {\n  res.json({\n    status: 'OK',\n    database: mongoose.connection.readyState === 1 ? 'connected' : 'disconnected',\n    timestamp: new Date()\n  });\n});\n\n// Start server\nconst PORT = process.env.PORT || 5000;\napp.listen(PORT, () => {\n  console.log(`ðŸš€ Server running on http://localhost:${PORT}`);\n  console.log(`ðŸ“Š MongoDB: ${mongoose.connection.readyState === 1 ? 'Connected' : 'Not connected'}`);\n});","map":{"version":3,"names":["express","require","mongoose","cors","config","app","use","origin","credentials","json","connect","process","env","MONGODB_URI","useNewUrlParser","useUnifiedTopology","then","console","log","catch","err","message","orderSchema","Schema","customer","fullName","String","email","phone","address","city","postalCode","items","productId","name","price","Number","quantity","image","subtotal","shipping","tax","total","paymentMethod","status","type","default","timestamps","Order","model","get","req","res","timestamp","Date","post","body","success","order","savedOrder","save","_id","orderId","error","details","errors","orders","find","sort","createdAt","count","length","findById","params","id","database","connection","readyState","PORT","listen"],"sources":["E:/Donut-Web/frontend/src/pages/Checkout.js"],"sourcesContent":["const express = require('express');\r\nconst mongoose = require('mongoose');\r\nconst cors = require('cors');\r\nrequire('dotenv').config();\r\n\r\nconst app = express();\r\n\r\n// Middleware\r\napp.use(cors({\r\n  origin: 'http://localhost:3000',\r\n  credentials: true\r\n}));\r\napp.use(express.json());\r\n\r\n// MongoDB Connection\r\nmongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/donutshop', {\r\n  useNewUrlParser: true,\r\n  useUnifiedTopology: true,\r\n})\r\n.then(() => console.log('âœ… MongoDB Connected'))\r\n.catch(err => {\r\n  console.log('âŒ MongoDB Connection Error:', err.message);\r\n  console.log('âš ï¸  Running in demo mode (no database)');\r\n});\r\n\r\n// Order Schema\r\nconst orderSchema = new mongoose.Schema({\r\n  customer: {\r\n    fullName: String,\r\n    email: String,\r\n    phone: String,\r\n    address: String,\r\n    city: String,\r\n    postalCode: String\r\n  },\r\n  items: [{\r\n    productId: String,\r\n    name: String,\r\n    price: Number,\r\n    quantity: Number,\r\n    image: String\r\n  }],\r\n  subtotal: Number,\r\n  shipping: Number,\r\n  tax: Number,\r\n  total: Number,\r\n  paymentMethod: String,\r\n  status: { type: String, default: 'pending' }\r\n}, { timestamps: true });\r\n\r\nconst Order = mongoose.model('Order', orderSchema);\r\n\r\n// Test route\r\napp.get('/api/test', (req, res) => {\r\n  res.json({ message: 'Backend is working!', timestamp: new Date() });\r\n});\r\n\r\n// Create order - FIXED 400 ERROR\r\napp.post('/api/orders', async (req, res) => {\r\n  try {\r\n    console.log('ðŸ“¦ Received order request:', req.body);\r\n    \r\n    // Validate required fields\r\n    if (!req.body.customer || !req.body.items) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Missing required fields: customer and items'\r\n      });\r\n    }\r\n\r\n    // Create order in database\r\n    const order = new Order({\r\n      ...req.body,\r\n      status: 'pending'\r\n    });\r\n\r\n    const savedOrder = await order.save();\r\n    \r\n    console.log('âœ… Order saved to DB:', savedOrder._id);\r\n    \r\n    res.status(201).json({\r\n      success: true,\r\n      message: 'Order created successfully',\r\n      order: savedOrder,\r\n      orderId: savedOrder._id\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('âŒ Order creation error:', error.message);\r\n    \r\n    // Send detailed error for debugging\r\n    res.status(500).json({\r\n      success: false,\r\n      message: 'Failed to create order',\r\n      error: error.message,\r\n      details: error.errors || 'No additional details'\r\n    });\r\n  }\r\n});\r\n\r\n// Get all orders\r\napp.get('/api/orders', async (req, res) => {\r\n  try {\r\n    const orders = await Order.find().sort({ createdAt: -1 });\r\n    res.json({\r\n      success: true,\r\n      count: orders.length,\r\n      orders: orders\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: 'Failed to fetch orders'\r\n    });\r\n  }\r\n});\r\n\r\n// Get single order\r\napp.get('/api/orders/:id', async (req, res) => {\r\n  try {\r\n    const order = await Order.findById(req.params.id);\r\n    if (!order) {\r\n      return res.status(404).json({\r\n        success: false,\r\n        message: 'Order not found'\r\n      });\r\n    }\r\n    res.json({\r\n      success: true,\r\n      order: order\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({\r\n      success: false,\r\n      message: 'Failed to fetch order'\r\n    });\r\n  }\r\n});\r\n\r\n// Health check\r\napp.get('/api/health', (req, res) => {\r\n  res.json({\r\n    status: 'OK',\r\n    database: mongoose.connection.readyState === 1 ? 'connected' : 'disconnected',\r\n    timestamp: new Date()\r\n  });\r\n});\r\n\r\n// Start server\r\nconst PORT = process.env.PORT || 5000;\r\napp.listen(PORT, () => {\r\n  console.log(`ðŸš€ Server running on http://localhost:${PORT}`);\r\n  console.log(`ðŸ“Š MongoDB: ${mongoose.connection.readyState === 1 ? 'Connected' : 'Not connected'}`);\r\n});"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}